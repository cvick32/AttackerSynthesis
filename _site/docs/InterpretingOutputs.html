<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>AttackerSynthesis | Tool, Models, and Supplementary Materials for Attacker Synthesis Project</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="AttackerSynthesis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tool, Models, and Supplementary Materials for Attacker Synthesis Project" />
<meta property="og:description" content="Tool, Models, and Supplementary Materials for Attacker Synthesis Project" />
<link rel="canonical" href="http://localhost:4000/docs/InterpretingOutputs.html" />
<meta property="og:url" content="http://localhost:4000/docs/InterpretingOutputs.html" />
<meta property="og:site_name" content="AttackerSynthesis" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/docs/InterpretingOutputs.html","headline":"AttackerSynthesis","description":"Tool, Models, and Supplementary Materials for Attacker Synthesis Project","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=5113cfe4cabec5e515d14f9fac0d83af9daf0acb">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">AttackerSynthesis</a></h1>
      

      <p><a href="/"><code class="language-plaintext highlighter-rouge">↞</code> Back to <strong>README.md</strong></a>, <a href="/docs/Korg.html"><code class="language-plaintext highlighter-rouge">↞</code> Back to <strong>Korg.md</strong></a></p>

<h1 id="interpreting-korgs-outputs">Interpreting Korg’s Outputs</h1>

<p align="center">
	Pictured: Korg Volca Beats, Bass, &amp; Keys.  Image courtesy of <a href="https://www.attackmagazine.com/reviews/gear-software/korg-volca-beats-bass-keys/2/">Attack Magazine</a>.
	<br><br>
	<img src="images/multiple_korgs.png">
</p>

<h2 id="with---characterizefalse">With <code class="language-plaintext highlighter-rouge">--characterize=False</code>
</h2>

<p>Suppose I run Korg wit the following parameters.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--model=demo/TCP/TCP.pml</code></li>
  <li><code class="language-plaintext highlighter-rouge">--phi=experiments/experiment1.pml</code></li>
  <li><code class="language-plaintext highlighter-rouge">--Q=demo/TCP/network.pml</code></li>
  <li><code class="language-plaintext highlighter-rouge">--IO=demo/TCP/IO.txt</code></li>
  <li><code class="language-plaintext highlighter-rouge">--max_attacks=1</code></li>
  <li><code class="language-plaintext highlighter-rouge">--with_recovery=False</code></li>
  <li><code class="language-plaintext highlighter-rouge">--name=experiment1</code></li>
  <li><code class="language-plaintext highlighter-rouge">--characterize=False</code></li>
</ul>

<p>Like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(env) mvh:AttackerSynthesis$ python3 Korg.py --model=demo/TCP/TCP.pml --phi=experiments/experiment1.pml --Q=demo/TCP/network.pml --IO=demo/TCP/IO.txt --max_attacks=1 --with_recovery=False --name=experiment1 --characterize=False
ltl exp1: [] ((! ((state[0]==0))) || (! ((state[1]==4))))
pan:1: assertion violated  !( !(( !((state[0]==0))|| !((state[1]==4))))) (at depth 36)
pan: wrote experiment1_daisy_check.pml.trail

(Spin Version 6.5.0 -- 17 July 2019)
Warning: Search not completed
	+ Partial Order Reduction

Full statespace search for:
	never claim         	+ (exp1)
	assertion violations	+ (if within scope of claim)
	acceptance   cycles 	+ (fairness disabled)
	invalid end states	- (disabled by never claim)

State-vector 108 byte, depth reached 359, errors: 1
     3742 states, stored
     7291 states, matched
    11033 transitions (= stored+matched)
        0 atomic steps
hash conflicts:         2 (resolved)

Stats on memory usage (in Megabytes):
    0.485	equivalent memory usage for states (stored*(State-vector + overhead))
    0.575	actual memory usage for states
  128.000	memory used for hash table (-w24)
    0.534	memory used for DFS stack (-m10000)
  129.022	total actual memory usage



pan: elapsed time 0.01 seconds
</code></pre></div></div>
<p>First of all, we can basically ignore the output in the command line.  This is just unsuppressed Spin output.</p>

<p>What we are really interested is the output in <code class="language-plaintext highlighter-rouge">out/experiment1_False</code>.  Notice the naming scheme is <code class="language-plaintext highlighter-rouge">out/$(name)_$(with_recovery)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(env) mvh:AttackerSynthesis$ tree out
out
└── experiment1_False
    └── attacker_0.pml

1 directory, 1 file

</code></pre></div></div>
<p>Let’s look at <code class="language-plaintext highlighter-rouge">attacker_0.pml</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* spin -t -s -r experiment1_daisy_check.pml */
active proctype attacker() {
	
	NtoA ! ACK;
	NtoB ! SYN;
	BtoN ? SYN_ACK;
	NtoB ! ACK;
	// Acceptance Cycle part of attack
}
</code></pre></div></div>
<p>The first line gives the command that was used to produce the trail file which was interpreted in order to synthesize this attacker.  The rest of the lines give us the <code class="language-plaintext highlighter-rouge">attacker()</code> process, which, in order:</p>

<ol>
  <li>Sends <code class="language-plaintext highlighter-rouge">ACK</code> over <code class="language-plaintext highlighter-rouge">NtoA</code> (called <code class="language-plaintext highlighter-rouge">Nto1</code> in the paper) (<img class="emoji" title=":exclamation:" alt=":exclamation:" src="https://github.githubassets.com/images/icons/emoji/unicode/2757.png" height="20" width="20">)</li>
  <li>Sends <code class="language-plaintext highlighter-rouge">SYN</code> over <code class="language-plaintext highlighter-rouge">NtoB</code> (called <code class="language-plaintext highlighter-rouge">Nto2</code> in the paper) (<img class="emoji" title=":exclamation:" alt=":exclamation:" src="https://github.githubassets.com/images/icons/emoji/unicode/2757.png" height="20" width="20">)</li>
  <li>Receives <code class="language-plaintext highlighter-rouge">SYN_ACK</code> over <code class="language-plaintext highlighter-rouge">BtoN</code> (called <code class="language-plaintext highlighter-rouge">2toN</code> in the paper) (<img class="emoji" title=":question:" alt=":question:" src="https://github.githubassets.com/images/icons/emoji/unicode/2753.png" height="20" width="20">)</li>
  <li>Sends <code class="language-plaintext highlighter-rouge">ACK</code> over <code class="language-plaintext highlighter-rouge">NtoB</code> (called <code class="language-plaintext highlighter-rouge">Nto2</code> in the paper) (<img class="emoji" title=":exclamation:" alt=":exclamation:" src="https://github.githubassets.com/images/icons/emoji/unicode/2757.png" height="20" width="20">)</li>
  <li>Does nothing forever. (<img class="emoji" title=":interrobang:" alt=":interrobang:" src="https://github.githubassets.com/images/icons/emoji/unicode/2049.png" height="20" width="20">)</li>
</ol>

<p>So, as a process, the attacker looks something like this.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              Nto1 ! ACK             Nto2 ! SYN
---&gt; ( s_0 ) ------------&gt; ( s_ 1) -------------&gt; ( s_3 )
                                                    |
                                                    | 2toN ? SYN_ACK
                                     Nto2 ! ACK     V
                           ( s_5 ) &lt;------------- ( s_4 )
</code></pre></div></div>

<p>Note that this attacker has a trivial acceptance cycle.  But we can also make an attacker with a non-trivial acceptance cycle, like so.</p>

<blockquote>
  <p>python3 Korg.py –model=demo/TCP/TCP.pml –phi=experiments/experiment2.pml –Q=demo/TCP/network.pml –IO=demo/TCP/IO.txt –max_attacks=3 –with_recovery=False –name=experiment2 –characterize=False</p>
</blockquote>

<p>Inspecting <code class="language-plaintext highlighter-rouge">experiment2_False/attacker_2.pml</code>, I see:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/* spin -t2 -s -r experiment2_daisy_check.pml */
active proctype attacker() {
	
	NtoA ! ACK;
	NtoB ! ACK;
	// Acceptance Cycle part of attack
	do
	::
	   BtoN ? SYN;
	od
}
</code></pre></div></div>

<p>Clearly this attacker has a non-trivial acceptance cycle (again, using the paper’s notation for the channels for my figure below):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>               Nto1 ! ACK           Nto2 ! ACK
----&gt; ( s_0 ) ------------&gt; ( s_1 ) -----------&gt; ( s_3 ) -----
                                                    ^        |
                                                    |        | 2toN ? SYN
                                                    ----------

                                               \_______ _________________/
                                                       V
                                            This is the non-trivial acceptance
                                            cycle.
</code></pre></div></div>

<h2 id="with---characterizetrue">With <code class="language-plaintext highlighter-rouge">--characterize=True</code>
</h2>

<p>Running the code with <code class="language-plaintext highlighter-rouge">--characterize=True</code> does everything that Korg would do with <code class="language-plaintext highlighter-rouge">--characterize=False</code>, plus it saves the <em>artifacts</em> and writes a log file.  This is best explained via an example.  Suppose I run the following.</p>

<blockquote>
  <p>python3 Korg.py –model=demo/TCP/TCP.pml –phi=experiments/experiment2.pml –Q=demo/TCP/network.pml –IO=demo/TCP/IO.txt –max_attacks=3 –with_recovery=True –name=experiment2 –characterize=True</p>
</blockquote>

<p>So, I am running the same experiment as I did immediately previously, except with recovery, and with <code class="language-plaintext highlighter-rouge">--characterize=True</code>.  Then in <code class="language-plaintext highlighter-rouge">out/experiment2_True/</code>, I find the following.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(env) mvh:AttackerSynthesis$ tree out/experiment2_True/
out/experiment2_True/
├── artifacts
│   ├── attacker_0_WITH_RECOVERY_A.pml
│   ├── attacker_0_WITH_RECOVERY_E.pml
│   ├── attacker_1_WITH_RECOVERY_A.pml
│   ├── attacker_1_WITH_RECOVERY_E.pml
│   ├── attacker_2_WITH_RECOVERY_A.pml
│   └── attacker_2_WITH_RECOVERY_E.pml
├── attacker_0_WITH_RECOVERY.pml
├── attacker_1_WITH_RECOVERY.pml
├── attacker_2_WITH_RECOVERY.pml
└── log.txt

</code></pre></div></div>

<p><img class="emoji" title=":scream:" alt=":scream:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f631.png" height="20" width="20"> Wow!  <img class="emoji" title=":open_file_folder:" alt=":open_file_folder:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4c2.png" height="20" width="20"> That’s a lot of files!  Let’s go over what each of them is, exactly.</p>

<ul>
  <li>
    <p><img class="emoji" title=":calendar:" alt=":calendar:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4c6.png" height="20" width="20"> <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code> is the first synthesized attacker, out of 3.  Obviously <code class="language-plaintext highlighter-rouge">attacker_1_WITH_RECOVERY.pml</code> is the second, and <code class="language-plaintext highlighter-rouge">attacker_2_WITH_RECOVERY.pml</code> is the third.</p>

    <ul>
      <li>Actually, these three models are all exactly the same.  Sometimes I find that I need to run with a fairly large <code class="language-plaintext highlighter-rouge">--max_attacks</code> in order to get more than one <em>distinct</em> attacker.  The problem arises from non-determinism in <code class="language-plaintext highlighter-rouge">P</code>, or, in this case, <code class="language-plaintext highlighter-rouge">TCP.pml</code>.</li>
    </ul>
  </li>
  <li>
    <p><img class="emoji" title=":spiral_notepad:" alt=":spiral_notepad:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f5d2.png" height="20" width="20"> <code class="language-plaintext highlighter-rouge">log.txt</code>.  This is a comma-separated-value (CSV) text file following the format <code class="language-plaintext highlighter-rouge">model,A/E,with_recovery?</code>.  So, column 1 gives the name of the attacker model (e.g., <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code>); column 2 says <code class="language-plaintext highlighter-rouge">A-attack</code> if it is a ∀-attacker, <code class="language-plaintext highlighter-rouge">E-attack</code> if it is an ∃-attacker, or <code class="language-plaintext highlighter-rouge">NOT AN ATTACK</code> if somehow the code made a mistake (which should not happen … so if this does happen, please file an issue in the <a href="https://github.com/maxvonhippel/AttackerSynthesis/issues">Issue Tracker</a>); and column 3 says <code class="language-plaintext highlighter-rouge">True</code> iff it is an attacker with recovery, or <code class="language-plaintext highlighter-rouge">False</code> otherwise.</p>
  </li>
  <li>
    <p><img class="emoji" title=":chart_with_upwards_trend:" alt=":chart_with_upwards_trend:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4c8.png" height="20" width="20"> <code class="language-plaintext highlighter-rouge">artifacts/attacker_0_WITH_RECOVERY_A.pml</code> reports no violations or acceptance cycles when run with <code class="language-plaintext highlighter-rouge">spin -run -a</code>, if and only if <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code> is a ∀-attacker.  Otherwise, it reports one or more violations or acceptance cycles.</p>

    <ul>
      <li>
        <p>Inspecting this file is a good way for you to understand <em>how</em> we check this.  The basic idea is to see if <code class="language-plaintext highlighter-rouge">P</code> composed with <code class="language-plaintext highlighter-rouge">attacker</code> <em>satisfies</em> the <em>negation</em> of <code class="language-plaintext highlighter-rouge">phi</code>.</p>
      </li>
      <li>
        <p>Likewise, <code class="language-plaintext highlighter-rouge">artifacts/attacker_1_WITH_RECOVERY_A.pml</code> serves the same purpose for <code class="language-plaintext highlighter-rouge">attacker_1_WITH_RECOVERY.pml</code>, and, <code class="language-plaintext highlighter-rouge">artifacts/attacker_2_WITH_RECOVERY_A.pml</code> serves the same puspose for <code class="language-plaintext highlighter-rouge">attacker_2_WITH_RECOVERY.pml</code>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><img class="emoji" title=":clipboard:" alt=":clipboard:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cb.png" height="20" width="20"> <code class="language-plaintext highlighter-rouge">artifacts/attacker_0_WITH_RECOVERY_E.pml</code> reports at least one violation or acceptance cycle iff <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code> is an attacker.  So:</p>

    <ul>
      <li>if <code class="language-plaintext highlighter-rouge">spin -run -a artifacts/attacker_0_WITH_RECOVERY_E.pml</code> reports at least one violation or acceptance cycle, and <code class="language-plaintext highlighter-rouge">spin -run -a artifacts/attacker_0_WITH_RECOVERY_A.pml</code> does not, then <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code> is a ∀-attacker;</li>
      <li>if both commands report each at least one violation or acceptance cycle, then <code class="language-plaintext highlighter-rouge">attacker_0_WITH_RECOVERY.pml</code> is an ∃-attacker;</li>
      <li>if neither command reports at least one violation or acceptance cycle, then there is something <em>very very wrong</em> with the code, and you should submit the inputs and outputs for us to inspect on the <a href="https://github.com/maxvonhippel/AttackerSynthesis/issues">Issue Tracker</a>;</li>
      <li>likewise, if <code class="language-plaintext highlighter-rouge">spin -run -a artifacts/attacker_0_WITH_RECOVERY_E.pml</code> reports no violation or acceptance cycle, but <code class="language-plaintext highlighter-rouge">spin -run -a artifacts/attacker_0_WITH_RECOVERY_A.pml</code> reports at least one violation or acceptance cycle, then there is something <em>very very wrong</em> with the code, and you should submit the inputs and outputs for us to inspect on the <a href="https://github.com/maxvonhippel/AttackerSynthesis/issues">Issue Tracker</a>.</li>
      <li>Obviously <code class="language-plaintext highlighter-rouge">artifacts/attacker_$n_WITH_RECOVERY_E.pml</code> and <code class="language-plaintext highlighter-rouge">artifacts_attacker_$n_WITH_RECOVERY_A.pml</code> serve the same respective purposes for the attacker <code class="language-plaintext highlighter-rouge">attacker_$n_WITH_RECOVERY.pml</code>, for <code class="language-plaintext highlighter-rouge">$n ∈ { 0, 1, 2 }</code>.</li>
    </ul>
  </li>
</ul>

<h3 id="ψ"><code class="language-plaintext highlighter-rouge">Ψ</code></h3>

<p>There is one more thing for us to notice here: <code class="language-plaintext highlighter-rouge">Ψ</code>.  In the paper, we take a property <code class="language-plaintext highlighter-rouge">Φ</code>, and we construct a new property <code class="language-plaintext highlighter-rouge">Ψ = (G (recover ⇒ Φ))</code>.  We use a bit <code class="language-plaintext highlighter-rouge">b</code> to detect recovery in our models, like so:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bit b= 0;
active proctype daisy () {
	do
	:: AtoN?ACK;
	:: AtoN?FIN;
	:: AtoN?SYN;
	
	// etc etc etc

	:: break; // recovery to N ... 
	od
	b = 1;
	// N begins here ... 

	do
	:: AtoN ? SYN -&gt; 
		if
		:: NtoB ! SYN;
		fi unless timeout;
	:: BtoN ? SYN -&gt; 
		if
		:: NtoA ! SYN;
		fi unless timeout;
	
	// etc etc etc

	:: _nr_pr &lt; 3 -&gt; break;
	od
end:

}
</code></pre></div></div>

<p>Then, given a <code class="language-plaintext highlighter-rouge">Φ</code>, for example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ltl exp2 {
	( (always ( eventually ( state[0] == 1 &amp;&amp; state[1] == 2 ) ) ) 
		implies ( eventually ( state[0] == 4 ) ) )
}

</code></pre></div></div>
<p>… we can construct a <code class="language-plaintext highlighter-rouge">Ψ</code>, as evident at the top-level directory in <code class="language-plaintext highlighter-rouge">experiment2_daisy_check.pml</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ltl newPhi {
	always ( ( b == 1 ) implies (
		
	( (always ( eventually ( state[0] == 1 &amp;&amp; state[1] == 2 ) ) ) 
		implies ( eventually ( state[0] == 4 ) ) )
  ) )
}
</code></pre></div></div>
<p>However, we do not use this property in our <code class="language-plaintext highlighter-rouge">artifacts</code>, because we know that there must exist a violating run with <code class="language-plaintext highlighter-rouge">b == 1</code> in order for us to get a result in the first place.</p>

<p>If this worries you, you can add the bit <code class="language-plaintext highlighter-rouge">b</code> back in to the attacker before recovery, and run the artifacts with <code class="language-plaintext highlighter-rouge">Ψ</code>, and you should get the expected results.</p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
